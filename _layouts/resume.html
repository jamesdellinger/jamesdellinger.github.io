<!-- 
The look and feel of this resume is best summed up as 
"more LinkedIn than LinkedIn." For better or worse, it 
has become the standard. 

Why this matters: when looking at a resume on a screen, this 
look and feel adds the least amount of cognitive overload 
to readers. In other words, it "gets out of the way" the 
most quickly, allowing the reader to focus on the content
without having to consciously figure out the resume's structure.
-->

<!-- Github uses Jekyll to build static webpages. So I can use 
Liquid to fit the content of the resume's markdown file
into the html template defined below. -->

<!doctype html>
<html lang="en">
  <head>
    <link rel="icon" type="image/png" href="../images/favicon.png"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">
    <title>{{ page.title }}</title>
    <link rel="stylesheet" href="/css/resume.css">
  </head>
  <body>
    <!-- Get text of individual's name, to use at the resume title. -->
    {% assign nameText = content | split: "</h1>" | first | strip_html %}

    <!-- Assume contact email address is first.lastname@gmail.com. We'll reverse 
    it and display that reversed email address in HTML. We'll use CSS to 
    display the un-reversed email whenever the resume is printed out. This 
    simple and robust trick should prevent virtually all scraping.
    From https://superuser.com/a/235965 -->
    {% assign reversedEmail = nameText | split: "" | reverse | join:"" | split: " " | join: "." | downcase | prepend: "moc.liamg@" %}

    <!-- Drop-down header for desktop display. -->
    <header>
      <div class="header_title_container">
        <div class="header_profile_pic_container">
          <a href="/">
            <img class="header_profile_pic" src="../images/resume_pic_400.jpeg" alt="Header Profile Pic">
          </a>
        </div>
        <p class="header_title_text">{{ nameText }}</p>
      </div>
    </header>
    <!-- Use headroom.js (https://wicky.nillia.ms/headroom.js/) to gently slide the header down, 
         making it visible once the user has begun to scroll downwards from the top. -->
    <script src="/js/headroom.js"></script>
    <script>
        const header = document.querySelector("header");
        const scroll_offset = 300; // Num pixels that must be scrolled before headroom.js changes header's class from --top to --not_top.
        const options = {
          offset: scroll_offset,
        }
        const headroom = new Headroom(header, options);
        headroom.init();
    </script>

    <!-- In the markdown file I use a horizontal rule to delineate each section, which is rendered in html as "<hr />" -->
    {% assign sectionArray = content | split: "<hr />" %}
    {% for section in sectionArray %}
      {% if forloop.first %}
        <section id="top_section" class="top_section">

          <!-- Background banner and profile pic for desktop display. -->
          <div class="top_section_background_image_container">
            <img class="top_section_background_image" alt="Background Image" src="../images/resume_top_background.jpeg">
          </div>
          <div class="top_section_profile_pic_container">
            <a href="/">
              <img class="top_section_profile_pic" alt="Profile Pic" src="../images/resume_pic_400.jpeg">
            </a>
          </div>

          <!-- Profile pic and name header for mobile display. -->
          <div class="top_section_profile_pic_title_container_mobile">
            <div class="profile_pic_container_mobile">
              <a href="/">
                <img class="profile_pic_mobile" src="../images/resume_pic_400.jpeg" alt="Profile Pic">
              </a>
            </div>
            <p class="name_header_mobile">{{ nameText }}</p>
          </div>

          <!-- Name header and contact info for desktop/mobile and print display.
           In the markdown file, location is directly under name (which is inside
           and <h1> tag). Email is directly under location. All subsequent lines 
           will be links to other websites, like github or kaggle. -->
          {% assign contactInfoArray = section | split: "</h1>" | last | split: "<h2" | first | split: "</p>" %}
          {% assign locationText = contactInfoArray | first | strip_html | strip %}
          {% assign emailAddressText = contactInfoArray | slice: 1 | first | strip_html %}
          {% assign contactInfoArrayLastIndex = contactInfoArray.size | minus: 3 %}
          {% assign contactLinkArray = contactInfoArray | slice: 2, contactInfoArrayLastIndex %}
          <div class="name_and_contact_links_container">
            <h1>{{ nameText }}</h1>
            <div class="my_location_and_contact_links_container">
              <p class="email_print"><span style="unicode-bidi:bidi-override; direction: rtl;">{{ reversedEmail }}</span></p>
              <p class="my_location">{{ locationText }}</p>
              <div class="email_contact_links_container">
                <p class="email_screen">{{ emailAddressText }}</p>
                <div class="contact_links_container">
                {% for item in contactLinkArray %}
                  {% if item contains "href" %}
                      <p class="contact_link">{{ item | split: "p>" | last }}</p>
                  {% endif %}
                {% endfor %}
                </div>
              </div>
            </div>
          </div>

          <!-- Objective header and objective text. -->
          {% assign objective = section | split: "<h2" | last  %}
          <h2{{ objective }}          
        </section> 

      {% elsif forloop.index0 == 1 %}
        <!-- Experience section always comes second. -->
        <section id="experience_section">
        <!-- Markdown file uses the <h3> tag to display company name and city. -->
        {% assign companiesArray = section | split: "<h3" %}
        <!-- Section <h2> header inside the first item. Each subsequent item contains a company. -->
        {{ companiesArray | first }}

        {% for company in companiesArray offset: 1 %}
          <!-- Format company header. Include city if markdown file listed it in the company header, inside parentheses. -->
          {% assign companyHeaderText = company | split: "</h3>" | first | split: ">" | last %}
          {% assign companyCityText = "" %}
          {% assign companyDateText = "" %}
          <!-- Company header contains a date if an en-dash is in its text. -->
          {% if companyHeaderText contains "–" %}
            {% assign companyHeaderArray = companyHeaderText |  split: ", " %}
            {% assign companyDateText = companyHeaderArray | last | strip_html %}
            {% if companyHeaderArray.size > 2 %}
              {% assign companyHeaderText = companyHeaderArray | first | append: ", " | append: companyHeaderArray[1] %}
            {% else %}
              {% assign companyHeaderText = companyHeaderArray | first | strip_html %}
            {% endif %}
          {% endif %}
          {% if companyHeaderText contains " (" %}
            {% assign companyCityText = companyHeaderText | split: " (" | last | split: ")" | first | strip_html %}
            {% assign companyNameText = companyHeaderText | split: " (" | first | strip_html %}
          {% endif %}

          {% if forloop.last %}
            <div class="last_company_or_degree_container">
          {% else %}
            <div class="company_or_degree_container">
          {% endif %}
          <div class="company_header_container">
            <div class="company_name_city_container"><h3>{{ companyNameText }}</h3><p class="company_city">{{ companyCityText }}</p></div>
            <p class="company_date">{{ companyDateText }}</p>
          </div>

          <!-- Markdown file stores each job inside its on <h4> header. --> 
          {% assign jobsArray = company | split: "</h3>" | last | split: "<h4" %}
          <!-- If there is a company description, it will be in the first item. -->
          {% assign companyDescriptionText = jobsArray | first | strip_html %}
          {% if companyDescriptionText.size > 1 %}
              <p class="company_description">{{ companyDescriptionText }}</p>
          {% endif %}

          {% assign n_jobs = jobsArray.size | minus: 1 %}
          {% assign last_index = n_jobs | minus: 1 %}
          <div> <!-- Very important. This div will hold the job bullets/chevrons. -->
          {% for item in jobsArray offset: 1 %}
            <!-- When there are three or more jobs, middle jobs get chevrons while
            top and bottom jobs get bullets. 
            When there are only two jobs, all jobs get bullets. -->
            {% if n_jobs > 2 and forloop.index0 > 0 and forloop.index0 < last_index %}
              <!-- Useful for cropping SVG borders to image content: https://svgcrop.com/ -->
              <svg class="jobBulletChevron" xmlns="http://www.w3.org/2000/svg" viewBox="5.36 8 13.3 7.66">
                <path d="M17.657 15.657a1 1 0 0 1-.707-.293L12 10.414l-4.95 4.95a1 1 0 0 1-1.414-1.414l5.657-5.657a1 1 0 0 1 1.414 0l5.657 5.657a1 1 0 0 1-.707 1.707z"/>
              </svg>
            {% elsif n_jobs > 1 %}
              <span class="jobBulletCircle"></span>
            {% endif %}

            <!-- Add a horizontal bar in between jobs, if a single company 
            has multiple jobs. -->
            {% if n_jobs > 1 and forloop.last != true %}
              <div class="jobBar">
            {% else %}
              <div>
            {% endif %}

            <!-- Format job header. Include date if markdown file listed it in the job header, after a comma. -->
            {% assign jobNameText = item | split: "</h4>" | first | split: ">" | last | strip_html | strip %}
            {% assign jobDateText = "" %}
            {% if jobNameText contains ", " %}
              {% assign jobDateText = jobNameText | split: ", " | last %}
              {% assign jobNameText = jobNameText | split: ", " | first %}
            {% endif %}
            {% assign jobDescriptionText = item | split: "</h4>" | last %}
            {% assign jobDescriptionText = jobDescriptionText | strip_html | strip %}
            {% if forloop.last %}
              <div class="last_job_container">
            {% else %}
              <div class="job_container">
            {% endif %}
              <div class="job_description_container"> 
                {% if n_jobs > 1 %}
                  <h4>{{ jobNameText }}</h4><p class="job_date_mobile">{{ jobDateText }}</p><p class="job_description_text">{{ jobDescriptionText }}</p>
                {% else %}
                <h4>{{ jobNameText }}</h4><p class="job_description_text">{{ jobDescriptionText }}</p>
                {% endif %}
              </div>
              <p class="job_date">{{ jobDateText }}</p>
            </div> <!-- Closes the job_container or last_job_container div -->

            </div> <!-- Closes out the jobBar div -->
          {% endfor %}
          </div> <!-- Closes the jobs section div holding the bullets/chevrons -->
          </div> <!-- Closes the company div -->

          {% if forloop.last == false %}
            <hr>
          {% endif %}
        {% endfor %}
        </section>
      
      {% elsif forloop.index0 == 3 %}
        <!-- Education section is always fourth. -->
        <section id="education_section">
        <!-- Markdown file uses the <h3> tag to display company name and city. -->
        {% assign degreesArray = section | split: "<h3" %}
        <!-- Section <h2> header inside the first item. Each subsequent item contains a degree. -->
        {{ degreesArray | first }}
        {% for degree in degreesArray offset: 1 %}
          {% assign degreeHeaderText = degree | split: "</h3>" | first | split: ">" | last %}
          {% assign degreeHeaderArray = degreeHeaderText | split: ", " %}
          {% assign univNameText = degreeHeaderArray | first | strip_html %}
          {% assign degreeNameText = degreeHeaderArray[1] | strip_html %}
          {% assign degreeDateText = degreeHeaderArray | last | strip_html %}
          {% if forloop.last %}
            <div class="last_company_or_degree_container">
          {% else %}
            <div class="company_or_degree_container">
          {% endif %}
            <div class="univ_name_degree_date_container">
              <h3>{{ univNameText }}</h3>
              <div class="univ_degree_date_container"><p class="degree_name">{{ degreeNameText }}</p><p>{{ degreeDateText }}</p></div>
            </div>
          {% assign degreeDescriptionText = degree | split: "</h3>" | last | strip_html %}
          <p class="degree_description">{{ degreeDescriptionText }}</p>
          </div>
        {% endfor %}
        </section>
      
      {% elsif forloop.last %}
        <!-- Languages/hobbies section always comes last. -->
        <section class="last_section" id="lanuages_hobbies_section">
          <!-- Place two spaces after colon, to keep consistent with format in between each job title and description. -->
          {% assign languagesText = section | split: "</p>" | first | strip_html | replace_first: ": ", ":&nbsp;&nbsp;" %}
          {% assign hobbiesText =  section | split: "<p>" | last | split: "</p" | first | replace_first: ": ", ":&nbsp;&nbsp;" %}
          <p class="language_hobbies_text">{{ languagesText }}</p>
          <p class="language_hobbies_text">{{ hobbiesText }}</p>
        </section>

      {% else %}
        <section>
          {{ section }}
        </section>
      {% endif %}
    {% endfor %}

    <footer>
      © <script>document.write(/\d{4}/.exec(Date())[0])</script>&nbsp;{{ nameText }}
    </footer>
  </body>
</html>