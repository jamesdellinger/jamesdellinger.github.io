<!-- 
The look and feel of this resume is best summed up as 
"more LinkedIn than LinkedIn." For better or worse, it 
has become the standard. 

Why this matters: when looking at a resume on a screen, this 
look and feel adds the least amount of cognitive overload 
to readers. In other words, it "gets out of the way" the 
quickest. It lets the resume's content lodge itself
in the reader's mind without forcing him to spend too much 
effort disentangling its format and structure.
-->

<!doctype html>
<html lang="en">
  <head>
    <link rel="icon" type="image/png" href="../images/favicon.png"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">
    <title>{{ page.title }}</title>
    <link rel="stylesheet" href="/css/resume.css">
  </head>
  <body>
    <!-- Get text of individual's name, to use at the resume title. -->
    {% assign nameText = content | split: "</h1>" | first | split: ">" | last %}

    <!-- Assume contact email address is first.lastname@gmail.com. We'll reverse 
    it and display that reversed email address in HTML. We'll use CSS to 
    display the un-reversed email whenever the resume is printed out. This 
    simple and robust trick should prevent virtually all scraping.
    From https://superuser.com/a/235965 -->
    {% assign reversedEmail = nameText | split: "" | reverse | join:"" | split: " " | join: "." | downcase | prepend: "moc.liamg@" %}

    <!-- Drop-down header for desktop display. -->
    <header>
      <div class="header_title_container">
        <div class="header_profile_pic_container">
          <a href="/">
            <img class="header_profile_pic" src="../images/resume_pic_400.jpeg" alt="Header Profile Pic">
          </a>
        </div>
        <p class="header_title_text">{{ nameText }}</p>
      </div>
    </header>
    <!-- Use headroom.js (https://wicky.nillia.ms/headroom.js/) to gently slide the header down, 
         making it visible once the user has begun to scroll downwards from the top. -->
    <script src="/js/headroom.js"></script>
    <script>
        const header = document.querySelector("header");
        const scroll_offset = 300; // Num pixels that must be scrolled before headroom.js changes header's class from --top to --not_top.
        const options = {
          offset: scroll_offset,
        }
        const headroom = new Headroom(header, options);
        headroom.init();
    </script>

    <!-- Github uses Jekyll to build static webpages. So use Liquid to 
    split the .md file into sections. (The string "===" is used to denote
    section splits in the .md file. It is of course rendered as <p>===</p> once 
    the file has been parsed.) -->
    
    {% assign sectionBreak = "<p>===</p>" %}
    {% assign sectionArray = content | split: sectionBreak %}
    {% for section in sectionArray %}
      {% if forloop.first %}
        <section id="top_section">

          <!-- Background banner and profile pic for desktop display. -->
          <div class="top_section_background_image_container">
            <img class="top_section_background_image" alt="Background Image" src="../images/resume_top_background.jpeg">
          </div>
          <div class="top_section_profile_pic_container">
            <a href="/">
              <img class="top_section_profile_pic" alt="Profile Pic" src="../images/resume_pic_400.jpeg">
            </a>
          </div>

          <!-- Profile pic and name header for mobile display. -->
          <div class="top_section_profile_pic_title_container_mobile">
            <div class="profile_pic_container_mobile">
              <a href="/">
                <img class="profile_pic_mobile" src="../images/resume_pic_400.jpeg" alt="Profile Pic">
              </a>
            </div>
            <p class="name_header_mobile">{{ nameText }}</p>
          </div>

          <!-- Name header and contact info for desktop and print display. -->
          <div class="name_header_contact_info">
            <h1>{{ nameText }}</h1>
            <!-- Contact info listed in <p> tags, in between the </h1> tag of the name header, and the 
            <h2> tag of the Objective header. -->
            {% assign contactInfoArray = section | split: "</h1>" | last | split: "<h2>" | first | split: "</p>" %}
            <div class="contact_info">
            {% for item in contactInfoArray %}
              {% if item contains ", " %}
                {% assign locationText = item | split: ">" | last %}
                <p class="location">{{ locationText }}</p>
              {% elsif item contains "@" %}
                {% assign desktopEmailAddressText = item | split: ">" | last %}
                <p class="email">{{ desktopEmailAddressText }}</p>
                <p class="email_print"><span style="unicode-bidi:bidi-override; direction: rtl;">{{ reversedEmail }}</span></p>
              {% elsif item contains "<a" %}
                <p class="contact_link">{{ item | split: "p>" | last }}</p>
              {% endif %}
            {% endfor %}
            </div>
          </div>

          <!-- Objective header and objective text. -->
          {% assign objective = section | split: "<h2" | last  %}
          <h2{{ objective }}          
        </section> 

      {% elsif forloop.index0 == 1 %}
      <!-- Experience section always second section. -->
        <section id="experience_section">
        <!-- {% assign companyBreak = "<hr />" %} -->
        {% assign companyBreak = "<h3" %}
        {% assign companiesArray = section | split: companyBreak %}
        <!-- EXPERIENCE header inside the first item. Each subsequent
        item contains a single company. -->
        {{ companiesArray | slice: 0 | split: "</h2>" | first }}</h2>
        <!-- Markdown file uses the <h3> tag to display company name, city, and dates -->
        <!-- Break apart markdown h3 header and re-form it into:
          <div class="company_header"><div class="company_name_city><p class="company_name">NAME</p><p class="city">CITY</p></div><p class="date">DATE</p></div> -->
        {% for company in companiesArray offset: 1 %}
          {% assign companyHeaderBreak = "</h3>" %}
          {% assign companyHeader = company | split: companyHeaderBreak | first %}
          {% assign companyBody = company | split: companyHeaderBreak | last %}
          <!-- {% if forloop.first %}
            <!-- Make sure Experience <h2> header placed at top of experience section. -->
            {% assign experienceSectionHeader = companyHeader | split: "</h2>" | first %}
            {{ experienceSectionHeader }}</h2>
          {% endif %} -->
          <div class="company">
          <div class="company_header">
          <div class="company_name_city">
          {% assign companyNameText = companyHeader | split: " (" | first | split: ">" | last %}
          <p class="company_name">{{ companyNameText }}</p>
          {% assign companyCityText = companyHeader | split: " (" | last | split: ")" | first %}
          <p class="city">&nbsp;({{ companyCityText }})</p></div>
          {% assign companyDateText = companyHeader | split: "), " | last %}
          <p class="date">{{ companyDateText }}</p></div>

          <!-- Separate job title header <h4> header from job description text. 
          Handle special case where one company has multiple job titles 
          (and thus multiple <h4> headers). -->
          {% assign jobBreak = "<h4" %}
          {% assign jobsArray = companyBody | split: jobBreak %}
          {% assign n_jobs = jobsArray.size %}
          <!-- Some companies may not have a job title. In this situation just display the job description. -->
          {% if n_jobs == 1 %}
            <div class="job_description_text">{{ companyBody }}</div>
          <!-- The standard situation, a company has one job title. -->
          {% elsif n_jobs == 2 %}
            {% assign jobNameText = jobsArray | split: "</h4>" | first | split: ">" | last %}
            {% assign jobDescriptionText = jobsArray | split: "</h4>" | last | split: "<p>" | last | split: "</p>" | first  %} 
            <div class="job_header">{{ jobNameText }}</div>
            <div class="job_description_text"><p>{{ jobDescriptionText }}</p></div>
          <!-- When a company has two or more job titles. -->
          {% else %}
            {% assign last_index = n_jobs | minus: 1 %}
            <!-- Check to see if a company description is included before
            the job headers, when a company has multiple jobs. -->
            {% assign jobsArrayFirstItemArray = jobsArray | first | split: "</p" %}
            {% if jobsArrayFirstItemArray.size > 1 %}
              {% assign companyDescriptionText = jobsArrayFirstItemArray | first | split: ">" | last %}
              <p class="company_description_text">{{ companyDescriptionText }}</p>
            {% endif %}

            <!-- If there was no company description, first item of jobs array will
            be empty. Either way, we should get rid of it before formatting each
            job heading under a single company.  -->
            {% assign jobsArray = jobsArray | slice: 1, last_index %}
            {% assign n_jobs = n_jobs | minus: 1 %}
            {% assign last_index = last_index | minus: 1 %}

            {% for item in jobsArray %}
              <!-- Define gray bullets/chevrons/vertical bars to appear in left margin.
            
              When there are three or more jobs, middle jobs get chevrons while
              top and bottom jobs get bullets. When there are only two jobs, all
              jobs get bullets. We also draw a vertical gray bar in between bullets/chevrons. -->
              
              <div>
              {% if forloop.index0 > 0 and forloop.index0 < last_index and n_jobs > 2 %}
                <!-- Useful for cropping SVG borders to image content: https://svgcrop.com/ -->
                <svg class="jobBulletChevron" xmlns="http://www.w3.org/2000/svg" viewBox="5.36 8 13.3 7.66">
                  <path d="M17.657 15.657a1 1 0 0 1-.707-.293L12 10.414l-4.95 4.95a1 1 0 0 1-1.414-1.414l5.657-5.657a1 1 0 0 1 1.414 0l5.657 5.657a1 1 0 0 1-.707 1.707z"/>
                </svg>
              {% else %}
                <span class="jobBulletCircle"></span>
              {% endif %}
              {% if forloop.last %}
                <div class="job">
              {% else %}
                <div class="job jobBar">
              {% endif %}

              <!-- Format job headers. -->
              {% assign jobNameText = item | split: "</h4>" | first | split: ">" | last | split: ", " | first %}
              {% assign jobDateText = item | split: "</h4>" | first | split: ">" | last | split: ", " | last %}
              {% assign jobDescriptionText = item | split: "</h4>" | last %}
              <div class="job_header_name_date"><p class="job_header_name">{{ jobNameText }}</p><p class="date">{{ jobDateText }}</p></div>
              <div class="job_description_text">{{ jobDescriptionText }}</div>
              </div>
              </div>
            {% endfor %}
          {% endif %}

          </div>
          {% if forloop.last == false %}
            <hr>
          {% endif %}
        {% endfor %}
        </section>
      {% elsif forloop.index0 == 3 %}
        <!-- Education section always fourth section. -->
        <section id="education_section">
          {% assign educationH2Header = section | split: "<h4" | first %}
          {{ educationH2Header }}
          {% assign  majorNameText = section | split: "</h4>" | first | split: ">" | last | split: ", " | first %}
          {% assign  degreeText = section | split: "</h4>" | first | split: ">" | last | split: ", " | slice: 1 %}
          {% assign  gradDateText = section | split: "</h4>" | first | split: ">" | last | split: ", " | slice: 2 %}
          <div class="major_header_date"><h4 class="majorNameText">{{ majorNameText }}</h4><p class="education_date">{{ degreeText }}, {{ gradDateText }}</p></div>
          {% assign  educationDescriptionText = section | split: "<p>" | last | split: "</p" | first %}
          <p class="education_description">{{ educationDescriptionText  }}</p>
        </section>
      {% elsif forloop.last %}
        <!-- Languages/hobbies section always comes last. -->
        <section id="lanuages_hobbies_section">
          {% assign languagesText = section | split: "</p>" | first | split: ">" | last %}
          {% assign hobbiesText =  section | split: "<p>" | last | split: "</p" | first %}
          <p class="languages_text">{{ languagesText }}</p>
          <p class="hobbies_text">{{ hobbiesText }}</p>
        </section>
      {% else %}
        <section>
          {{ section }}
        </section>
      {% endif %}
    {% endfor %}

    <footer>
      © <script>document.write(/\d{4}/.exec(Date())[0])</script> James Dellinger
    </footer>
  </body>
</html>